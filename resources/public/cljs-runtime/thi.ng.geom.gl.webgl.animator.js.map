{"version":3,"sources":["thi/ng/geom/gl/webgl/animator.cljs"],"mappings":";;AAEA,AAAKA,AACH,AAAAC,AACC,AAAyBC;AAD1B,AAAA,AAAAD;AAAAA;;AAAA,AAAAA,AAEC,AAA+BC;AAFhC,AAAA,AAAAD;AAAAA;;AAAA,AAAAA,AAGC,AAA4BC;AAH7B,AAAA,AAAAD;AAAAA;;AAAA,AAAAA,AAIC,AAA2BC;AAJ5B,AAAA,AAAAD;AAAAA;;AAKC,AAA0BC;;;;;;AAE7B,AAAA,AAAMC;AAAN,AAEE,AAAAF,AACC,AAAMG;AADP,AAAA,AAAAH;AAAAA;;AAAA,AAAAA,AAEC,AAAYG;AAFb,AAAA,AAAAH;AAAAA;;AAAA,AAAAA,AAGC,AAASG;AAHV,AAAA,AAAAH;AAAAA;;AAAA,AAAAA,AAIC,AAAQG;AAJT,AAAA,AAAAH;AAAAA;;AAKC,AAAOG;;;;;;AAEV,AAAA,AAAA,AAAAC,AAAME;AAAN,AAAA,AAAAD,AAAA,AAAA;AAAA,AAAA,AAAAA;AAAA;AAAA,AAAAC,AAAA,AAAA,AAAA;;;AAAA;AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA;;;;AAAA,AAAA,AAAAC,AAAA,AAAA,AAAA,AAAA;;;;;AAAA,AAAA,AAAA,AAAMD,AACFE;AADJ,AAEG,AAAA,AAACC,AAAQD;;;AAFZ,AAAA,AAAA,AAAMF,AAGFE,AAAEE;AAHN,AAIG,AAAMC,AAAI,AAAU,AAAAC;AACdC,AAAI,AAAA,AAACC;AACLC,AAAI;AAAA,AACE,AAAI,AAAAC,AAAG,AAAA,AAAG,AAAG,AAAU,AAAAJ,AAAYD;AAA/BM,AAAyC,AAAA,AAAA,AAAA,AAAQJ,AAAAA;AAAjD,AAAA,AAAAG,AAAAC,AAAAD,AAAAC,AAACT,AAAAA,AAAAA;;AACH,AAAIE;AACF,AAACX,AAAAA,AAAAA,AAAmBmB,AAAAA,AAASR,AAAAA;;AAC7B,AAACX,AAAAA,AAAAA,AAAmBmB,AAAAA;;;AAHxB;;;AAHZ,AAOE,AAACH;;;AAXN,AAAA,AAAA,AAAMT;;AAAN","names":["thi.ng.geom.gl.webgl.animator/animframe-provider","or__4185__auto__","js/self","thi.ng.geom.gl.webgl.animator/now","js/performance","var_args","G__29925","thi.ng.geom.gl.webgl.animator/animate","js/Error","f","thi.ng.geom.gl.webgl.animator.animate.cljs$core$IFn$_invoke$arity$2","element","t0","js/Date","fid","cljs.core/volatile!","f'","G__29931","G__29932","animate*"],"sourcesContent":["(ns thi.ng.geom.gl.webgl.animator)\n\n(def animframe-provider\n  (or\n   (.-requestAnimationFrame js/self)\n   (.-webkitRequestAnimationFrame js/self)\n   (.-mozRequestAnimationFrame js/self)\n   (.-msRequestAnimationFrame js/self)\n   (.-oRequestAnimationFrame js/self)))\n\n(defn now\n  []\n  (or\n   (.now js/performance)\n   (.webkitNow js/performance)\n   (.mozNow js/performance)\n   (.msNow js/performance)\n   (.oNow js/performance)))\n\n(defn animate\n  ([f]\n   (animate f nil))\n  ([f element]\n   (let [t0  (.getTime (js/Date.))\n         fid (volatile! 0)\n         f'  (fn animate* []\n               (if (f (* (- (.getTime (js/Date.)) t0) 1e-3) (vswap! fid inc))\n                 (if element\n                   (animframe-provider animate* element)\n                   (animframe-provider animate*))))]\n     (f'))))\n"]}